/*! 
 Build based on gin-vue-admin 
 Time : 1671085367000 */
var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,i=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,u=(e,l,a)=>new Promise(((t,i)=>{var u=e=>{try{o(a.next(e))}catch(l){i(l)}},n=e=>{try{o(a.throw(e))}catch(l){i(l)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(u,n);o((a=a.apply(e,l)).next())}));import{g as n,d as o,f as s,a as r,c as d,u as c}from"./gin-vue-admin-banner.16710853670002.js";import{_ as p}from"./gin-vue-admin-index.167108536700016.js";import{C as v}from"./gin-vue-admin-index.167108536700011.js";import{_ as m}from"./gin-vue-admin-index.167108536700024.js";import"./gin-vue-admin-date.1671085367000.js";import"./gin-vue-admin-dictionary.16710853670002.js";import{u as g}from"../gva/gin-vue-admin-index.1671085367000.js";import{r as f,i as y,o as b,j as h,q as _,k as w,t as k,A as x,C as j,J as z,L as V,H as C,v as I,O as D,x as O,d as U,e as S}from"./gin-vue-admin-vendor.1671085367000.js";import"./gin-vue-admin-image.1671085367000.js";import"./gin-vue-admin-warningBar.1671085367000.js";/* empty css                                                                             */import"./gin-vue-admin-area.16710853670002.js";import"./gin-vue-admin-sysDictionary.1671085367000.js";const B={class:"gva-search-box"},P=x("查询"),A=x("重置"),T={class:"gva-table-box"},E={class:"gva-btn-list"},$=x("新增"),q=_("p",null,"确定要删除吗？",-1),H={style:{"text-align":"right","margin-top":"8px"}},J=x("取消"),K=x("确定"),L=x("删除"),R=x("变更"),F=x("删除"),G={class:"gva-pagination"},M=x("重新上传"),N={class:"dialog-footer"},Q=x("取 消"),W=x("确 定"),X={name:"Banner"},Y=Object.assign(X,{setup(e){const X=f("/api"),Y=g(),Z=f("https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif?imageView2/1/w/80/h/80"),ee=f({title:"",city:"",class:"",img:"",url:""}),le=f(1),ae=f(0),te=f(10),ie=f([]),ue=f({}),ne=f([{ID:1,title:"首页"}]),oe=e=>u(this,null,(function*(){console.log("子组件传的值",e),ee.value.city=e})),se=e=>u(this,null,(function*(){console.log("图片地址",e),Z.value="/api/"+e,ee.value.img=e})),re=f(!1),de=e=>{re.value=!0;const l="image/jpeg"===e.type,a="image/png"===e.type,t=e.size/1024/1024<.5;return l||a||(U.error("上传图片只能是 jpg或png 格式!"),re.value=!1),t||(U.error("未压缩未见上传图片大小不能超过 500KB，请使用压缩上传"),re.value=!1),(a||l)&&t},ce=e=>{if(re.value=!1,console.log("图片",e),0===e.code){var l=e.data.file.url;Z.value="/api/"+l,console.log("图片地址",Z.value),ee.value.img=l,U({type:"success",message:"上传成功"}),0===e.code&&be()}else U({type:"warning",message:e.msg})},pe=()=>{U({type:"error",message:"上传失败"}),re.value=!1},ve=f(null),me=()=>{ue.value={}},ge=()=>{le.value=1,te.value=10,be()},fe=e=>{te.value=e,be()},ye=e=>{le.value=e,be()},be=()=>u(this,null,(function*(){const e=yield n(((e,u)=>{for(var n in u||(u={}))a.call(u,n)&&i(e,n,u[n]);if(l)for(var n of l(u))t.call(u,n)&&i(e,n,u[n]);return e})({page:le.value,pageSize:te.value},ue.value));0===e.code&&(ie.value=e.data.list,ae.value=e.data.total,le.value=e.data.page,te.value=e.data.pageSize)}));be();(()=>{u(this,null,(function*(){}))})();const he=f([]),_e=e=>{he.value=e},we=f(!1),ke=()=>u(this,null,(function*(){const e=[];if(0===he.value.length)return void U({type:"warning",message:"请选择要删除的数据"});he.value&&he.value.map((l=>{e.push(l.ID)}));0===(yield o({ids:e})).code&&(U({type:"success",message:"删除成功"}),ie.value.length===e.length&&le.value>1&&le.value--,we.value=!1,be())})),xe=f(""),je=e=>u(this,null,(function*(){const l=yield s({ID:e.ID});xe.value="update",0===l.code&&(ee.value=l.data.rebanner,Z.value="/api/"+l.data.rebanner.img,Ve.value=!0)})),ze=e=>u(this,null,(function*(){0===(yield r({ID:e.ID})).code&&(U({type:"success",message:"删除成功"}),1===ie.value.length&&le.value>1&&le.value--,be())})),Ve=f(!1),Ce=()=>{xe.value="create",Ve.value=!0},Ie=()=>{Ve.value=!1,ee.value={title:"",city:"",class:"",img:"",url:""}},De=()=>u(this,null,(function*(){let e;switch(xe.value){case"create":e=yield d(ee.value);break;case"update":e=yield c(ee.value);break;default:e=yield d(ee.value)}0===e.code&&(U({type:"success",message:"创建/更改成功"}),Ie(),be())}));return(e,l)=>{const a=y("el-input"),t=y("el-form-item"),i=y("el-button"),u=y("el-form"),n=y("el-popover"),o=y("el-table-column"),s=y("el-table"),r=y("el-pagination"),d=y("el-option"),c=y("el-select"),g=y("el-upload"),f=y("el-dialog");return b(),h("div",null,[_("div",B,[w(u,{inline:!0,model:ue.value,class:"demo-form-inline"},{default:k((()=>[w(t,{label:"城市"},{default:k((()=>[w(a,{modelValue:ue.value.cityId,"onUpdate:modelValue":l[0]||(l[0]=e=>ue.value.cityId=e),placeholder:"搜索条件"},null,8,["modelValue"])])),_:1}),w(t,{label:"分类"},{default:k((()=>[w(a,{modelValue:ue.value.classId,"onUpdate:modelValue":l[1]||(l[1]=e=>ue.value.classId=e),placeholder:"搜索条件"},null,8,["modelValue"])])),_:1}),w(t,null,{default:k((()=>[w(i,{size:"small",type:"primary",icon:"search",onClick:ge},{default:k((()=>[P])),_:1}),w(i,{size:"small",icon:"refresh",onClick:me},{default:k((()=>[A])),_:1})])),_:1})])),_:1},8,["model"])]),_("div",T,[_("div",E,[w(i,{size:"small",type:"primary",icon:"plus",onClick:Ce},{default:k((()=>[$])),_:1}),w(n,{visible:we.value,"onUpdate:visible":l[3]||(l[3]=e=>we.value=e),placement:"top",width:"160"},{reference:k((()=>[w(i,{icon:"delete",size:"small",style:{"margin-left":"10px"},disabled:!he.value.length},{default:k((()=>[L])),_:1},8,["disabled"])])),default:k((()=>[q,_("div",H,[w(i,{size:"small",type:"text",onClick:l[2]||(l[2]=e=>we.value=!1)},{default:k((()=>[J])),_:1}),w(i,{size:"small",type:"primary",onClick:ke},{default:k((()=>[K])),_:1})])])),_:1},8,["visible"])]),w(s,{ref:"multipleTable",style:{width:"100%"},"tooltip-effect":"dark",data:ie.value,"row-key":"ID",onSelectionChange:_e},{default:k((()=>[w(o,{align:"center",label:"标题",prop:"title",width:"120"}),w(o,{align:"center",label:"城市",prop:"city",width:"120"}),w(o,{align:"center",label:"分类",prop:"class",width:"120"},{default:k((e=>[x(j(1==e.row.class?"首页":"")+" "+j(2==e.row.class?"国内捎带":"")+" "+j(3==e.row.class?"组团拼车":"")+" "+j(4==e.row.class?"团购接龙":"")+" "+j(5==e.row.class?"二手闲置":""),1)])),_:1}),w(o,{align:"center",label:"图片",width:"220"},{default:k((e=>[w(v,{"pic-type":"file","pic-src":e.row.img},null,8,["pic-src"])])),_:1}),w(o,{align:"center",label:"链接",prop:"url",width:"120"}),w(o,{align:"center",label:"按钮组"},{default:k((e=>[w(i,{type:"text",icon:"edit",size:"small",class:"table-button",onClick:l=>je(e.row)},{default:k((()=>[R])),_:2},1032,["onClick"]),w(i,{type:"text",icon:"delete",size:"small",onClick:l=>{return a=e.row,void S.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{ze(a)}));var a}},{default:k((()=>[F])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),_("div",G,[w(r,{layout:"total, sizes, prev, pager, next, jumper","current-page":le.value,"page-size":te.value,"page-sizes":[10,30,50,100],total:ae.value,onCurrentChange:ye,onSizeChange:fe},null,8,["current-page","page-size","total"])])]),w(p,{ref_key:"chooseImgRef",ref:ve,onEnterImg:se},null,512),w(f,{modelValue:Ve.value,"onUpdate:modelValue":l[7]||(l[7]=e=>Ve.value=e),"before-close":Ie,title:"弹窗操作"},{footer:k((()=>[_("div",N,[w(i,{size:"small",onClick:Ie},{default:k((()=>[Q])),_:1}),w(i,{size:"small",type:"primary",onClick:De},{default:k((()=>[W])),_:1})])])),default:k((()=>[w(u,{model:ee.value,"label-position":"right","label-width":"80px"},{default:k((()=>[w(t,{label:"标题:"},{default:k((()=>[w(a,{modelValue:ee.value.title,"onUpdate:modelValue":l[4]||(l[4]=e=>ee.value.title=e),clearable:"",placeholder:"请输入"},null,8,["modelValue"])])),_:1}),w(t,{label:"分类:"},{default:k((()=>[w(c,{modelValue:ee.value.class,"onUpdate:modelValue":l[5]||(l[5]=e=>ee.value.class=e),placeholder:"请选择分类",style:{width:"58rem"}},{default:k((()=>[(b(!0),h(z,null,V(ne.value,(e=>(b(),C(d,{key:e.ID,value:e.ID,label:e.title},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),1==ee.value.class?(b(),C(t,{key:0,label:"城市:"},{default:k((()=>[w(m,{onSelectArea:oe})])),_:1})):I("",!0),w(t,{label:"图片:"},{default:k((()=>[_("div",{class:"user-headpic-update",style:D({"background-image":`url(${Z.value})`,"background-repeat":"no-repeat","background-size":"cover",width:"200px"})},null,4),w(g,{action:`${X.value}/fileUploadAndDownload/upload`,"before-upload":de,headers:{"x-token":O(Y).token},"on-error":pe,"on-success":ce,"show-file-list":!1,class:"upload-btn"},{default:k((()=>[w(i,{size:"small",type:"primary"},{default:k((()=>[M])),_:1})])),_:1},8,["action","headers"])])),_:1}),w(t,{label:"链接:"},{default:k((()=>[w(a,{modelValue:ee.value.url,"onUpdate:modelValue":l[6]||(l[6]=e=>ee.value.url=e),clearable:"",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}});export{Y as default};
