/*! 
 Build based on gin-vue-admin 
 Time : 1671085367000 */
var e=(e,a,l)=>new Promise(((t,o)=>{var i=e=>{try{s(l.next(e))}catch(a){o(a)}},u=e=>{try{s(l.throw(e))}catch(a){o(a)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,u);s((l=l.apply(e,a)).next())}));import{s as a}from"../gva/gin-vue-admin-index.1671085367000.js";import{w as l}from"./gin-vue-admin-warningBar.1671085367000.js";import{f as t}from"./gin-vue-admin-format.1671085367000.js";import{r as o,i,o as u,j as s,k as n,q as r,t as d,C as m,x as c,A as v,d as p}from"./gin-vue-admin-vendor.1671085367000.js";import"./gin-vue-admin-date.1671085367000.js";import"./gin-vue-admin-dictionary.1671085367000.js";import"./gin-vue-admin-dictionary.16710853670002.js";import"./gin-vue-admin-sysDictionary.1671085367000.js";const f=e=>a({url:"/customer/customer",method:"post",data:e}),g={class:"gva-table-box"},h={class:"gva-btn-list"},y=v("新增"),b=v("变更"),w=r("p",null,"确定要删除吗？",-1),C={style:{"text-align":"right","margin-top":"8px"}},k=v("取消"),_=v("确定"),z=v("删除"),x={class:"gva-pagination"},D={class:"dialog-footer"},j=v("取 消"),V=v("确 定"),I={name:"Customer"},P=Object.assign(I,{setup(v){const I=o({customerName:"",customerPhoneData:""}),P=o(1),U=o(0),N=o(10),S=o([]),A=e=>{N.value=e,B()},q=e=>{P.value=e,B()},B=()=>e(this,null,(function*(){const e=yield(l={page:P.value,pageSize:N.value},a({url:"/customer/customerList",method:"get",params:l}));var l;0===e.code&&(S.value=e.data.list,U.value=e.data.total,P.value=e.data.page,N.value=e.data.pageSize)}));B();const L=o(!1),O=o(""),T=l=>e(this,null,(function*(){const e=yield(t={ID:l.ID},a({url:"/customer/customer",method:"get",params:t}));var t;O.value="update",0===e.code&&(I.value=e.data.customer,L.value=!0)})),E=()=>{L.value=!1,I.value={customerName:"",customerPhoneData:""}},F=l=>e(this,null,(function*(){l.visible=!1;var e;0===(yield(e={ID:l.ID},a({url:"/customer/customer",method:"delete",data:e}))).code&&(p({type:"success",message:"删除成功"}),1===S.value.length&&P.value>1&&P.value--,B())})),G=()=>e(this,null,(function*(){let e;switch(O.value){case"create":e=yield f(I.value);break;case"update":e=yield(l=I.value,a({url:"/customer/customer",method:"put",data:l}));break;default:e=yield f(I.value)}var l;0===e.code&&(E(),B())})),H=()=>{O.value="create",L.value=!0};return(e,a)=>{const o=i("el-button"),v=i("el-table-column"),p=i("el-popover"),f=i("el-table"),B=i("el-pagination"),O=i("el-input"),J=i("el-form-item"),K=i("el-form"),M=i("el-dialog");return u(),s("div",null,[n(l,{title:"在资源权限中将此角色的资源权限清空 或者不包含创建者的角色 即可屏蔽此客户资源的显示"}),r("div",g,[r("div",h,[n(o,{size:"small",type:"primary",icon:"plus",onClick:H},{default:d((()=>[y])),_:1})]),n(f,{ref:"multipleTable",data:S.value,style:{width:"100%"},"tooltip-effect":"dark","row-key":"ID"},{default:d((()=>[n(v,{type:"selection",width:"55"}),n(v,{align:"left",label:"接入日期",width:"180"},{default:d((e=>[r("span",null,m(c(t)(e.row.CreatedAt)),1)])),_:1}),n(v,{align:"left",label:"姓名",prop:"customerName",width:"120"}),n(v,{align:"left",label:"电话",prop:"customerPhoneData",width:"120"}),n(v,{align:"left",label:"接入人ID",prop:"sysUserId",width:"120"}),n(v,{align:"left",label:"按钮组","min-width":"160"},{default:d((e=>[n(o,{size:"small",type:"text",icon:"edit",onClick:a=>T(e.row)},{default:d((()=>[b])),_:2},1032,["onClick"]),n(p,{visible:e.row.visible,"onUpdate:visible":a=>e.row.visible=a,placement:"top",width:"160"},{reference:d((()=>[n(o,{type:"text",icon:"delete",size:"small",onClick:a=>e.row.visible=!0},{default:d((()=>[z])),_:2},1032,["onClick"])])),default:d((()=>[w,r("div",C,[n(o,{size:"small",type:"text",onClick:a=>e.row.visible=!1},{default:d((()=>[k])),_:2},1032,["onClick"]),n(o,{type:"primary",size:"small",onClick:a=>F(e.row)},{default:d((()=>[_])),_:2},1032,["onClick"])])])),_:2},1032,["visible","onUpdate:visible"])])),_:1})])),_:1},8,["data"]),r("div",x,[n(B,{"current-page":P.value,"page-size":N.value,"page-sizes":[10,30,50,100],total:U.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:q,onSizeChange:A},null,8,["current-page","page-size","total"])])]),n(M,{modelValue:L.value,"onUpdate:modelValue":a[2]||(a[2]=e=>L.value=e),"before-close":E,title:"客户"},{footer:d((()=>[r("div",D,[n(o,{size:"small",onClick:E},{default:d((()=>[j])),_:1}),n(o,{size:"small",type:"primary",onClick:G},{default:d((()=>[V])),_:1})])])),default:d((()=>[n(K,{inline:!0,model:I.value,"label-width":"80px"},{default:d((()=>[n(J,{label:"客户名"},{default:d((()=>[n(O,{modelValue:I.value.customerName,"onUpdate:modelValue":a[0]||(a[0]=e=>I.value.customerName=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),n(J,{label:"客户电话"},{default:d((()=>[n(O,{modelValue:I.value.customerPhoneData,"onUpdate:modelValue":a[1]||(a[1]=e=>I.value.customerPhoneData=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}});export{P as default};
